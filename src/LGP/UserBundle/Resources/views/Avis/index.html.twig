{% extends "LGPCoreBundle::layout.html.twig" %}

{% block title %}
  Avis - {{ parent() }}
{% endblock %}

{% block body %}
  <h1>Vos avis</h1>
  <p>
    <a href="{{ path('lgp_user_avis_add') }}" class="btn btn-primary">Ajouter</a>
  </p>

  {# Si l'utilisateur est Prof  #}
  {% if is_granted('ROLE_PROF') %}

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist">
      <li class="active"><a href="#envoyes" role="tab" data-toggle="tab">Envoyes</a></li>
      <li>
        <a href="#recus" role="tab" data-toggle="tab">
          Recus <span class="badge avis-link">{{ render (controller('LGPUserBundle:Avis:index', {'is_read': 'false'})) }}</span>
        </a>
      </li>
    </ul>
    <br>

    <!-- Tab panes -->
    <div class="tab-content">
      <div class="tab-pane active" id="envoyes">

        {% if avis|length <= 0 %}
          <h1 class="text-muted">Aucun avis trouvé !</h1>
        {% else %}
          <table class="table table-bordered table-hover table-striped avis-table">
            <thead>
              <tr>
                <th>Prof</th>
                <th>Note</th>
                <th>Commentaire</th>
                <th>Date</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for avs in avis %}
                <tr>
                  <td>
                    <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.prof.prenoms }} {{ avs.prof.nom }}</a>
                  </td>
                  <td>
                    <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.note }}</a>
                  </td>
                  <td>
                    <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.commentaire }}</a>
                  </td>
                  <td> {{ avs.dateAvis|date('d/m/Y') }}</td>
                  <td>
                    <a href='{{ path('lgp_user_avis_delete',  {'id': avs.id }) }}' class="bt btn-danger btn-sm delete_confirm">
                      Supprimer
                    </a>
                    <a href='{{ path('lgp_user_avis_update',  {'id': avs.id }) }}' class="bt btn-info btn-sm">
                      Modifier
                    </a>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>

          <div class='avis-details'></div>

        {% endif %}
      </div> {# end tab-pane recu#}

      <div class="tab-pane" id="recus">
        {% if avisReceived|length <= 0 %}
          <h1 class="text-muted">Aucun avis trouvé !</h1>
        {% else %}
          <table class="table table-bordered table-hover table-striped avis-table">
            <thead>
              <tr>
                <th>Prof</th>
                <th>Note</th>
                <th>Commentaire</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              {% for avs in avisReceived %}
                <tr>
                  <td>
                    <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.prof.prenoms }} {{ avs.prof.nom }}</a>
                  </td>
                  <td>
                    <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.note }}</a>
                  </td>
                  <td>
                    <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.commentaire }}</a>
                  </td>
                  <td>{{ avs.dateAvis|date('d/m/Y') }}
                </tr>
              {% endfor %}
            </tbody>
          </table>

          <div class='avis-details'></div>

        {% endif %}

      </div>{# end tab-pane recu#}
    </div>

  {# Si l'utilisateur est Parent        #}
  {% else %}

    {% if avis|length <= 0 %}
      <h1 class="text-muted">Aucun avis trouvé !</h1>
    {% else %}
      <table class="table table-bordered table-hover table-striped avis-table">
        <thead>
          <tr>
            <th>Prof</th>
            <th>Note</th>
            <th>Commentaire</th>
            <th>Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for avs in avis %}
            <tr>
              <td>
                <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.prof.prenoms }} {{ avs.prof.nom }}</a>
              </td>
              <td>
                <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.note }}</a>
              </td>
              <td>
                <a href="{{ path('lgp_user_avis_voir', {'id': avs.id}) }}" class="show-avis-link">{{ avs.commentaire }}</a>
              </td>
              <td> {{ avs.dateAvis|date('d/m/Y') }}</td>
              <td>
                <a href='{{ path('lgp_user_avis_delete',  {'id': avs.id }) }}' class="bt btn-danger btn-sm delete_confirm">
                  Supprimer
                </a>
                <a href='{{ path('lgp_user_avis_update',  {'id': avs.id }) }}' class="bt btn-info btn-sm">
                  Modifier
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class='avis-details'></div>

    {% endif %}
    
    
  {% endif %}

{% endblock %}